#!/usr/bin/env node

const Config = require('../dist/config/env.config').default;
const Log4js = require('koa-log4');
const devtool = require('../dist/app.js');
const app = devtool.default;
const WSServer = devtool.WSServer;

const logger = Log4js.getLogger('app');
const serve = app.listen(Config.listenPort, () => {
  logger.info('[worker:%s] web server start listen on %s.\naddress: %s', process.pid, Config.listenPort, `http://localhost:${Config.listenPort}`);
});
app.wss = WSServer.createWebSocketServer(serve, null, null, null, () => { });
